import{c as se}from"./JEhwILJ5.js";import{r as U,C as ae,ay as re,aA as oe,az as X,M as B,d4 as ue,I as D,e as T,w as z,g as $,G as c,a2 as te,aI as W,aR as P,a0 as O,ao as de,aD as Y,aE as ce,a6 as R,dp as Z,O as fe,y as ve,a3 as ge,a4 as pe,d as V,F as ee,D as ye,n as w,h as he,f as _,L as N,A as me,t as be,a7 as le,a5 as j}from"./Ca1n4UDm.js";import{M as ke}from"./CZokbzV0.js";import{u as Ie}from"./BD5rrKZc.js";import{u as xe}from"./CMZp_-CL.js";import{f as H}from"./fVWMYAkY.js";import{_ as Te}from"./BDzhkUQJ.js";import{_ as Ke}from"./DlTaqawE.js";import"./rxmVWDo5.js";function F(n){return n.reduce((y,e)=>(y.push(e),e.children&&y.push(...F(e.children)),y),[])}function Ce(n,y){const e=U(),f=(a,K)=>{if(y.multiple&&Array.isArray(n.value))if(y.selectionBehavior==="replace")n.value=[a],e.value=a;else{const h=n.value.findIndex(u=>K(u));h!==-1?n.value=n.value.filter((u,o)=>o!==h):n.value=[...n.value,a]}else y.selectionBehavior==="replace"?n.value={...a}:!Array.isArray(n.value)&&K(n.value)?n.value=void 0:n.value={...a};return n.value};function A(a,K,h,u){if(!e?.value||!y.multiple||!Array.isArray(n.value))return;const S=h().filter(b=>b.ref.dataset.disabled!=="").find(b=>b.ref===K)?.value;if(!S)return;let m=null;switch(a){case"prev":case"next":{m=H(u,e.value,S);break}case"first":{m=H(u,e.value,u?.[0]);break}case"last":{m=H(u,e.value,u?.[u.length-1]);break}}n.value=m}return{firstValue:e,onSelectItem:f,handleMultipleReplace:A}}const[Se,Ae]=re("TreeRoot"),Ee=ae({__name:"TreeRoot",props:{modelValue:{},defaultValue:{},items:{},expanded:{},defaultExpanded:{},getKey:{},getChildren:{type:Function,default:n=>n.children},selectionBehavior:{default:"toggle"},multiple:{},dir:{},disabled:{type:Boolean},propagateSelect:{type:Boolean},bubbleSelect:{type:Boolean},asChild:{type:Boolean},as:{default:"ul"}},emits:["update:modelValue","update:expanded"],setup(n,{emit:y}){const e=n,f=y,{items:A,multiple:a,disabled:K,propagateSelect:h,dir:u,bubbleSelect:o}=oe(e),{handleTypeaheadSearch:S}=Ie(),m=xe(u),b=U(),L=U(!1),d=ue(),s=X(e,"modelValue",f,{defaultValue:e.defaultValue??(a.value?[]:void 0),passive:e.modelValue===void 0,deep:!0}),p=X(e,"expanded",f,{defaultValue:e.defaultExpanded??[],passive:e.expanded===void 0,deep:!0}),{onSelectItem:t,handleMultipleReplace:l}=Ce(s,e),r=B(()=>a.value&&Array.isArray(s.value)?s.value.map(i=>e.getKey(i)):[e.getKey(s.value??{})]);function k(i,v=1,x){return i.reduce((g,C,M)=>{const Q=e.getKey(C),G=e.getChildren(C),ne=p.value.includes(Q),ie={_id:Q,value:C,index:M,level:v,parentItem:x,hasChildren:!!G,bind:{value:C,level:v,"aria-setsize":i.length,"aria-posinset":M+1}};return g.push(ie),G&&ne&&g.push(...k(G,v+1,C)),g},[])}const I=B(()=>{const i=e.items;return p.value.map(v=>v),k(i??[])});function q(i){if(L.value)d.trigger(i);else{const v=b.value?.getItems()??[];S(i.key,v)}}function E(i){if(L.value)return;const v=ke[i.key];de(()=>{l(v,Y(),b.value?.getItems,I.value.map(x=>x.value))})}function J(i){if(i.parentItem!=null&&Array.isArray(s.value)&&e.multiple){const v=I.value.find(x=>i.parentItem!=null&&e.getKey(x.value)===e.getKey(i.parentItem));v!=null&&(e.getChildren(v.value)?.every(g=>s.value.find(C=>e.getKey(C)===e.getKey(g)))?s.value=[...s.value,v.value]:s.value=s.value.filter(g=>e.getKey(g)!==e.getKey(v.value)),J(v))}}return Ae({modelValue:s,selectedKeys:r,onSelect:i=>{const v=g=>e.getKey(g??{})===e.getKey(i),x=e.multiple&&Array.isArray(s.value)?s.value?.findIndex(v)!==-1:void 0;if(t(i,v),e.bubbleSelect&&e.multiple&&Array.isArray(s.value)){const g=I.value.find(C=>e.getKey(C.value)===e.getKey(i));g!=null&&J(g)}if(e.propagateSelect&&e.multiple&&Array.isArray(s.value)){const g=F(e.getChildren(i)??[]);x?s.value=[...s.value].filter(C=>!g.some(M=>e.getKey(C??{})===e.getKey(M))):s.value=[...s.value,...g]}},expanded:p,onToggle(i){if(!(i?e.getChildren(i):void 0))return;const x=e.getKey(i)??i;p.value.includes(x)?p.value=p.value.filter(g=>g!==x):p.value.push(x)},getKey:e.getKey,getChildren:e.getChildren,items:A,expandedItems:I,disabled:K,multiple:a,dir:m,propagateSelect:h,bubbleSelect:o,isVirtual:L,virtualKeydownHook:d,handleMultipleReplace:l}),(i,v)=>(T(),D(c(Te),{ref_key:"rovingFocusGroupRef",ref:b,"as-child":"",orientation:"vertical",dir:c(m)},{default:z(()=>[$(c(te),{role:"tree",as:i.as,"as-child":i.asChild,"aria-multiselectable":c(a)?!0:void 0,onKeydown:[q,W(P(E,["shift"]),["up","down"])]},{default:z(()=>[O(i.$slots,"default",{flattenItems:I.value,modelValue:c(s),expanded:c(p)})]),_:3},8,["as","as-child","aria-multiselectable","onKeydown"])]),_:3},8,["dir"]))}}),we="tree.select",Be="tree.toggle",Le=ae({inheritAttrs:!1,__name:"TreeItem",props:{value:{},level:{},asChild:{type:Boolean},as:{default:"li"}},emits:["select","toggle"],setup(n,{expose:y,emit:e}){const f=n,A=e,a=Se(),{getItems:K}=ce(),h=B(()=>!!a.getChildren(f.value)),u=B(()=>{const t=a.getKey(f.value);return a.expanded.value.includes(t)}),o=B(()=>{const t=a.getKey(f.value);return a.selectedKeys.value.includes(t)}),S=B(()=>{if(a.bubbleSelect.value&&h.value&&Array.isArray(a.modelValue.value)){const t=F(a.getChildren(f.value)||[]);return t.some(l=>a.modelValue.value.find(r=>a.getKey(r)===a.getKey(l)))&&!t.every(l=>a.modelValue.value.find(r=>a.getKey(r)===a.getKey(l)))}else return a.propagateSelect.value&&o.value&&h.value&&Array.isArray(a.modelValue.value)?!F(a.getChildren(f.value)||[]).every(l=>a.modelValue.value.find(r=>a.getKey(r)===a.getKey(l))):void 0});function m(t){if(h.value)if(u.value){const l=K().map(E=>E.ref),r=Y(),k=l.indexOf(r),q=[...l].slice(k).find(E=>Number(E.getAttribute("data-indent"))===f.level+1);q&&q.focus()}else p(t)}function b(t){if(u.value)p(t);else{const l=K().map(E=>E.ref),r=Y(),k=l.indexOf(r),q=[...l].slice(0,k).reverse().find(E=>Number(E.getAttribute("data-indent"))===f.level-1);q&&q.focus()}}async function L(t){A("select",t),!t?.defaultPrevented&&a.onSelect(f.value)}async function d(t){A("toggle",t),!t?.defaultPrevented&&a.onToggle(f.value)}async function s(t){if(!t)return;const l={originalEvent:t,value:f.value,isExpanded:u.value,isSelected:o.value};Z(we,L,l)}async function p(t){if(!t)return;const l={originalEvent:t,value:f.value,isExpanded:u.value,isSelected:o.value};Z(Be,d,l)}return y({isExpanded:u,isSelected:o,isIndeterminate:S,handleToggle:()=>a.onToggle(f.value),handleSelect:()=>a.onSelect(f.value)}),(t,l)=>(T(),D(c(Ke),{"as-child":"",value:t.value,"allow-shift-key":""},{default:z(()=>[$(c(te),R(t.$attrs,{role:"treeitem",as:t.as,"as-child":t.asChild,"aria-selected":o.value,"aria-expanded":h.value?u.value:void 0,"aria-level":t.level,"data-indent":t.level,"data-selected":o.value?"":void 0,"data-expanded":u.value?"":void 0,onKeydown:[W(P(s,["self","prevent"]),["enter","space"]),l[0]||(l[0]=W(P(r=>c(a).dir.value==="ltr"?m(r):b(r),["prevent"]),["right"])),l[1]||(l[1]=W(P(r=>c(a).dir.value==="ltr"?b(r):m(r),["prevent"]),["left"]))],onClick:l[2]||(l[2]=P(r=>{s(r),p(r)},["stop"]))}),{default:z(()=>[O(t.$slots,"default",{isExpanded:u.value,isSelected:o.value,isIndeterminate:S.value,handleSelect:()=>c(a).onSelect(t.value),handleToggle:()=>c(a).onToggle(t.value)})]),_:3},16,["as","as-child","aria-selected","aria-expanded","aria-level","data-indent","data-selected","data-expanded","onKeydown"])]),_:3},8,["value"]))}}),qe={slots:{root:"relative isolate",item:"",listWithChildren:"ms-4.5 border-s border-default",itemWithChildren:"ps-1.5 -ms-px",link:"relative group w-full flex items-center text-sm before:absolute before:inset-y-px before:inset-x-0 before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2",linkLeadingIcon:"shrink-0",linkLabel:"truncate",linkTrailing:"ms-auto inline-flex gap-1.5 items-center",linkTrailingIcon:"shrink-0 transform transition-transform duration-200 group-data-expanded:rotate-180"},variants:{color:{primary:{link:"focus-visible:before:ring-primary"},secondary:{link:"focus-visible:before:ring-secondary"},success:{link:"focus-visible:before:ring-success"},info:{link:"focus-visible:before:ring-info"},warning:{link:"focus-visible:before:ring-warning"},error:{link:"focus-visible:before:ring-error"},neutral:{link:"focus-visible:before:ring-inverted"}},size:{xs:{link:"px-2 py-1 text-xs gap-1",linkLeadingIcon:"size-4",linkTrailingIcon:"size-4"},sm:{link:"px-2.5 py-1.5 text-xs gap-1.5",linkLeadingIcon:"size-4",linkTrailingIcon:"size-4"},md:{link:"px-2.5 py-1.5 text-sm gap-1.5",linkLeadingIcon:"size-5",linkTrailingIcon:"size-5"},lg:{link:"px-3 py-2 text-sm gap-2",linkLeadingIcon:"size-5",linkTrailingIcon:"size-5"},xl:{link:"px-3 py-2 text-base gap-2",linkLeadingIcon:"size-6",linkTrailingIcon:"size-6"}},selected:{true:{link:"before:bg-elevated"},false:{link:["hover:not-disabled:text-highlighted hover:not-disabled:before:bg-elevated/50","transition-colors before:transition-colors"]}},disabled:{true:{link:"cursor-not-allowed opacity-75"}}},compoundVariants:[{color:"primary",selected:!0,class:{link:"text-primary"}},{color:"secondary",selected:!0,class:{link:"text-secondary"}},{color:"success",selected:!0,class:{link:"text-success"}},{color:"info",selected:!0,class:{link:"text-info"}},{color:"warning",selected:!0,class:{link:"text-warning"}},{color:"error",selected:!0,class:{link:"text-error"}},{color:"neutral",selected:!0,class:{link:"text-highlighted"}}],defaultVariants:{color:"primary",size:"md"}},$e=["disabled"],We=Object.assign({inheritAttrs:!1},{__name:"UTree",props:{as:{type:null,required:!1},color:{type:null,required:!1},size:{type:null,required:!1},valueKey:{type:null,required:!1,default:"value"},labelKey:{type:null,required:!1,default:"label"},trailingIcon:{type:String,required:!1},expandedIcon:{type:String,required:!1},collapsedIcon:{type:String,required:!1},items:{type:null,required:!1},modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},multiple:{type:Boolean,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},expanded:{type:Array,required:!1},defaultExpanded:{type:Array,required:!1},selectionBehavior:{type:String,required:!1},propagateSelect:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},bubbleSelect:{type:Boolean,required:!1}},emits:["update:expanded","update:modelValue"],setup(n,{emit:y}){const e=n,f=y,A=fe(),a=ve(),K=ge(pe(e,"as","modelValue","defaultValue","items","multiple","expanded","disabled","propagateSelect","bubbleSelect"),f),[h,u]=se(),o=B(()=>le({extend:le(qe),...a.ui?.tree||{}})({color:e.color,size:e.size}));function S(d){return j(d,e.labelKey)}function m(d){return j(d,e.valueKey)??j(d,e.labelKey)}function b(d){const s=d.defaultExpanded?m(d):null,p=d.children?.flatMap(t=>b(t))??[];return[s,...p].filter(Boolean)}const L=B(()=>e.defaultExpanded??e.items?.flatMap(d=>b(d)));return(d,s)=>(T(),V(ee,null,[$(c(h),null,{default:z(({items:p,level:t})=>[(T(!0),V(ee,null,ye(p,(l,r)=>(T(),V("li",{key:`${t}-${r}`,class:w(t>0?o.value.itemWithChildren({class:[e.ui?.itemWithChildren,l.ui?.itemWithChildren]}):o.value.item({class:[e.ui?.item,l.ui?.item]}))},[$(c(Le),{"as-child":"",level:t,value:l,onToggle:l.onToggle,onSelect:l.onSelect},{default:z(({isExpanded:k,isSelected:I})=>[he("button",{type:"button",disabled:l.disabled||n.disabled,class:w(o.value.link({class:[e.ui?.link,l.ui?.link,l.class],selected:I,disabled:l.disabled||n.disabled}))},[O(d.$slots,l.slot||"item",R({ref_for:!0},{index:r,level:t,expanded:k,selected:I},{item:l}),()=>[O(d.$slots,l.slot?`${l.slot}-leading`:"item-leading",R({ref_for:!0},{index:r,level:t,expanded:k,selected:I},{item:l}),()=>[l.icon?(T(),D(N,{key:0,name:l.icon,class:w(o.value.linkLeadingIcon({class:[e.ui?.linkLeadingIcon,l.ui?.linkLeadingIcon]}))},null,8,["name","class"])):l.children?.length?(T(),D(N,{key:1,name:k?n.expandedIcon??c(a).ui.icons.folderOpen:n.collapsedIcon??c(a).ui.icons.folder,class:w(o.value.linkLeadingIcon({class:[e.ui?.linkLeadingIcon,l.ui?.linkLeadingIcon]}))},null,8,["name","class"])):_("",!0)]),S(l)||A[l.slot?`${l.slot}-label`:"item-label"]?(T(),V("span",{key:0,class:w(o.value.linkLabel({class:[e.ui?.linkLabel,l.ui?.linkLabel]}))},[O(d.$slots,l.slot?`${l.slot}-label`:"item-label",R({ref_for:!0},{item:l,index:r,level:t,expanded:k,selected:I},{item:l}),()=>[me(be(S(l)),1)])],2)):_("",!0),l.trailingIcon||l.children?.length||A[l.slot?`${l.slot}-trailing`:"item-trailing"]?(T(),V("span",{key:1,class:w(o.value.linkTrailing({class:[e.ui?.linkTrailing,l.ui?.linkTrailing]}))},[O(d.$slots,l.slot?`${l.slot}-trailing`:"item-trailing",R({ref_for:!0},{item:l,index:r,level:t,expanded:k,selected:I},{item:l}),()=>[l.trailingIcon?(T(),D(N,{key:0,name:l.trailingIcon,class:w(o.value.linkTrailingIcon({class:[e.ui?.linkTrailingIcon,l.ui?.linkTrailingIcon]}))},null,8,["name","class"])):l.children?.length?(T(),D(N,{key:1,name:n.trailingIcon??c(a).ui.icons.chevronDown,class:w(o.value.linkTrailingIcon({class:[e.ui?.linkTrailingIcon,l.ui?.linkTrailingIcon]}))},null,8,["name","class"])):_("",!0)])],2)):_("",!0)])],10,$e),l.children?.length&&k?(T(),V("ul",{key:0,class:w(o.value.listWithChildren({class:[e.ui?.listWithChildren,l.ui?.listWithChildren]}))},[$(c(u),{items:l.children,level:t+1},null,8,["items","level"])],2)):_("",!0)]),_:2},1032,["level","value","onToggle","onSelect"])],2))),128))]),_:3}),$(c(Ee),R({...c(K),...d.$attrs},{class:o.value.root({class:[e.ui?.root,e.class]}),"get-key":m,"default-expanded":L.value,"selection-behavior":n.selectionBehavior}),{default:z(()=>[$(c(u),{items:n.items,level:0},null,8,["items"])]),_:1},16,["class","default-expanded","selection-behavior"])],64))}});export{We as default};
