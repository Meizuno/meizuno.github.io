import{d6 as S,r as k,C as A,a1 as _,L as g,aA as y,S as w,e as K,w as N,U,G as x,a2 as B,aG as D,d7 as i,ak as I,au as v,d8 as E,d9 as M,da as P,db as h,dc as T,dd as R}from"./BfdczqJ-.js";const G=S(()=>k([]));function H(){const s=G();return{add(a){const n=s.value[0];a!==n&&n?.pause(),s.value=O(s.value,a),s.value.unshift(a)},remove(a){s.value=O(s.value,a),s.value[0]?.resume()}}}function O(s,a){const n=[...s],l=n.indexOf(a);return l!==-1&&n.splice(l,1),n}function V(s){return s.filter(a=>a.tagName!=="A")}const j=A({__name:"FocusScope",props:{loop:{type:Boolean,default:!1},trapped:{type:Boolean,default:!1},asChild:{type:Boolean},as:{}},emits:["mountAutoFocus","unmountAutoFocus"],setup(s,{emit:a}){const n=s,l=a,{currentRef:C,currentElement:b}=_(),p=k(null),F=H(),m=g({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}});y(t=>{if(!D)return;const e=b.value;if(!n.trapped)return;function o(c){if(m.paused||!e)return;const f=c.target;e.contains(f)?p.value=f:i(p.value,{select:!0})}function d(c){if(m.paused||!e)return;const f=c.relatedTarget;f!==null&&(e.contains(f)||i(p.value,{select:!0}))}function u(c){e.contains(p.value)||i(e)}document.addEventListener("focusin",o),document.addEventListener("focusout",d);const r=new MutationObserver(u);e&&r.observe(e,{childList:!0,subtree:!0}),t(()=>{document.removeEventListener("focusin",o),document.removeEventListener("focusout",d),r.disconnect()})}),y(async t=>{const e=b.value;if(await I(),!e)return;F.add(m);const o=v();if(!e.contains(o)){const u=new CustomEvent(E,T);e.addEventListener(E,r=>l("mountAutoFocus",r)),e.dispatchEvent(u),u.defaultPrevented||(M(V(P(e)),{select:!0}),v()===o&&i(e))}t(()=>{e.removeEventListener(E,c=>l("mountAutoFocus",c));const u=new CustomEvent(h,T),r=c=>{l("unmountAutoFocus",c)};e.addEventListener(h,r),e.dispatchEvent(u),setTimeout(()=>{u.defaultPrevented||i(o??document.body,{select:!0}),e.removeEventListener(h,r),F.remove(m)},0)})});function L(t){if(!n.loop&&!n.trapped||m.paused)return;const e=t.key==="Tab"&&!t.altKey&&!t.ctrlKey&&!t.metaKey,o=v();if(e&&o){const d=t.currentTarget,[u,r]=R(d);u&&r?!t.shiftKey&&o===r?(t.preventDefault(),n.loop&&i(u,{select:!0})):t.shiftKey&&o===u&&(t.preventDefault(),n.loop&&i(r,{select:!0})):o===d&&t.preventDefault()}}return(t,e)=>(K(),w(x(B),{ref_key:"currentRef",ref:C,tabindex:"-1","as-child":t.asChild,as:t.as,onKeydown:L},{default:N(()=>[U(t.$slots,"default")]),_:3},8,["as-child","as"]))}});export{j as _};
