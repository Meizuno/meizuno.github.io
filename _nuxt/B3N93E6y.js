import{r as T,I as F,G as t,N as _,o as ee,O as K,c8 as P,X as le,cJ as ie,y as ae,dh as te,d as p,e as n,g as A,w as E,f as m,F as M,W as c,h as w,D as se,n as u,ao as Z,A as R,t as C,E as re,a6 as G,aP as oe,V as $,J as ne,aM as ue,a2 as ce,a7 as J}from"./C3y5PP2h.js";import{d as de,e as fe,c as pe}from"./gu16_CE3.js";function ge(i){if(!i||i==="*")return;const y=i.split(",").map(b=>b.trim()).filter(b=>!b.startsWith("."));return y.length>0?y:void 0}function ve(i){const{accept:y="*",reset:b=!1,multiple:e=!1,dropzone:V=!0,onUpdate:x}=i,a=T(),g=T(),U=F(()=>ge(t(y))),q=r=>{!r||r.length===0||(r instanceof FileList&&(r=Array.from(r)),r.length>1&&!e&&(r=[r[0]]),x(r))},S=T(!1),v=_({open:()=>{}});function h(){v.open()}return ee(()=>{const{isOverDropZone:r}=V?de(g,{dataTypes:U.value,onDrop:q}):{isOverDropZone:T(!1)};K(r,B=>{S.value=B});const{onChange:L,open:N}=fe({accept:t(y),multiple:e,input:t(a),reset:b});v.open=N,L(B=>q(B))}),{isDragging:S,open:h,inputRef:a,dropzoneRef:g}}const me={slots:{root:"relative flex flex-col",base:["w-full flex-1 bg-default border border-default flex flex-col gap-2 items-stretch justify-center rounded-lg focus-visible:outline-2","transition-[background]"],wrapper:"flex flex-col items-center justify-center text-center",icon:"shrink-0",avatar:"shrink-0",label:"font-medium text-default mt-2",description:"text-muted mt-1",actions:"flex flex-wrap gap-1.5 shrink-0 mt-4",files:"",file:"relative",fileLeadingAvatar:"shrink-0",fileWrapper:"flex flex-col min-w-0",fileName:"text-default truncate",fileSize:"text-muted truncate",fileTrailingButton:""},variants:{color:{primary:"",secondary:"",important:"",info:"",success:"",warning:"",error:"",neutral:""},variant:{area:{wrapper:"px-4 py-3",base:"p-4"},button:{}},size:{xs:{base:"text-xs",icon:"size-4",file:"text-xs px-2 py-1 gap-1",fileWrapper:"flex-row gap-1"},sm:{base:"text-xs",icon:"size-4",file:"text-xs px-2.5 py-1.5 gap-1.5",fileWrapper:"flex-row gap-1"},md:{base:"text-sm",icon:"size-5",file:"text-xs px-2.5 py-1.5 gap-1.5"},lg:{base:"text-sm",icon:"size-5",file:"text-sm px-3 py-2 gap-2",fileSize:"text-xs"},xl:{base:"text-base",icon:"size-6",file:"text-sm px-3 py-2 gap-2"}},layout:{list:{root:"gap-2 items-start",files:"flex flex-col w-full gap-2",file:"min-w-0 flex items-center border border-default rounded-md w-full",fileTrailingButton:"ms-auto"},grid:{fileWrapper:"hidden",fileLeadingAvatar:"size-full rounded-lg",fileTrailingButton:"absolute -top-1.5 -end-1.5 p-0 rounded-full border-2 border-bg"}},position:{inside:"",outside:""},dropzone:{true:"border-dashed data-[dragging=true]:bg-elevated/25"},interactive:{true:""},highlight:{true:""},multiple:{true:""},disabled:{true:"cursor-not-allowed opacity-75"}},compoundVariants:[{color:"primary",class:"focus-visible:outline-primary"},{color:"secondary",class:"focus-visible:outline-secondary"},{color:"important",class:"focus-visible:outline-important"},{color:"info",class:"focus-visible:outline-info"},{color:"success",class:"focus-visible:outline-success"},{color:"warning",class:"focus-visible:outline-warning"},{color:"error",class:"focus-visible:outline-error"},{color:"primary",highlight:!0,class:"border-primary"},{color:"secondary",highlight:!0,class:"border-secondary"},{color:"important",highlight:!0,class:"border-important"},{color:"info",highlight:!0,class:"border-info"},{color:"success",highlight:!0,class:"border-success"},{color:"warning",highlight:!0,class:"border-warning"},{color:"error",highlight:!0,class:"border-error"},{color:"neutral",class:"focus-visible:outline-inverted"},{color:"neutral",highlight:!0,class:"border-inverted"},{size:"xs",layout:"list",class:{fileTrailingButton:"-me-1"}},{size:"sm",layout:"list",class:{fileTrailingButton:"-me-1.5"}},{size:"md",layout:"list",class:{fileTrailingButton:"-me-1.5"}},{size:"lg",layout:"list",class:{fileTrailingButton:"-me-2"}},{size:"xl",layout:"list",class:{fileTrailingButton:"-me-2"}},{variant:"button",size:"xs",class:{base:"p-1"}},{variant:"button",size:"sm",class:{base:"p-1.5"}},{variant:"button",size:"md",class:{base:"p-1.5"}},{variant:"button",size:"lg",class:{base:"p-2"}},{variant:"button",size:"xl",class:{base:"p-2"}},{layout:"grid",multiple:!0,class:{files:"grid grid-cols-2 md:grid-cols-3 gap-4 w-full",file:"p-0 aspect-square"}},{layout:"grid",multiple:!1,class:{file:"absolute inset-0 p-0"}},{interactive:!0,disabled:!1,class:"hover:bg-elevated/25"}],defaultVariants:{color:"primary",variant:"area",size:"md"}},ye=["id","name","accept","multiple","required","disabled"],xe=Object.assign({inheritAttrs:!1},{__name:"UFileUpload",props:P({as:{type:null,required:!1},id:{type:String,required:!1},name:{type:String,required:!1},icon:{type:String,required:!1},label:{type:String,required:!1},description:{type:String,required:!1},color:{type:null,required:!1},variant:{type:null,required:!1},size:{type:null,required:!1},layout:{type:null,required:!1,default:"grid"},position:{type:null,required:!1,default:"outside"},highlight:{type:Boolean,required:!1},accept:{type:String,required:!1,default:"*"},multiple:{type:Boolean,required:!1,default:!1},reset:{type:Boolean,required:!1,default:!1},dropzone:{type:Boolean,required:!1,default:!0},interactive:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},fileIcon:{type:String,required:!1},fileDelete:{type:[Boolean,Object],required:!1},fileDeleteIcon:{type:String,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1}},{modelValue:{type:null},modelModifiers:{}}),emits:P(["update:modelValue","change"],["update:modelValue"]),setup(i,{expose:y,emit:b}){const e=i,V=b,x=le(),a=ie(i,"modelValue"),g=ae(),[U,q]=pe(),{isDragging:S,open:v,inputRef:h,dropzoneRef:r}=ve({accept:e.accept,reset:e.reset,multiple:e.multiple,dropzone:e.dropzone,onUpdate:O}),{emitFormInput:L,emitFormChange:N,id:B,name:X,disabled:W,ariaAttrs:H}=te(e),z=F(()=>e.multiple?"area":e.variant),j=F(()=>e.variant==="button"&&!e.multiple?"grid":e.layout),D=F(()=>j.value==="grid"&&e.multiple?"inside":z.value==="button"?"outside":e.position),s=F(()=>J({extend:J(me),...g.ui?.fileUpload||{}})({dropzone:e.dropzone,interactive:e.interactive,color:e.color,size:e.size,variant:z.value,layout:j.value,position:D.value,multiple:e.multiple,highlight:e.highlight,disabled:e.disabled}));function Q(l){return URL.createObjectURL(l)}function Y(l){if(l===0)return"0B";const f=1024,o=["B","KB","MB","GB"],d=Math.floor(Math.log(l)/Math.log(f)),I=l/Math.pow(f,d);return`${d===0?I.toString():I.toFixed(0)}${o[d]}`}function O(l,f=!1){if(e.multiple)if(f)a.value=l;else{const d=a.value||[];a.value=[...d,...l||[]]}else a.value=l?.[0];const o=new Event("change",{target:{value:a.value}});V("change",o),N(),L()}function k(l){if(!a.value)return;if(!e.multiple||l===void 0){O([],!0);return}const f=[...a.value];f.splice(l,1),O(f,!0)}return K(a,l=>{(!Array.isArray(l)||!l.length)&&h.value&&(h.value.value="")}),y({inputRef:h,dropzoneRef:r}),(l,f)=>(n(),p(M,null,[A(t(U),null,{default:E(()=>[a.value&&(!Array.isArray(a.value)||a.value.length)?(n(),p(M,{key:0},[c(l.$slots,"files-top",{files:a.value,open:t(v),removeFile:k}),w("div",{class:u(s.value.files({class:e.ui?.files}))},[c(l.$slots,"files",{files:a.value},()=>[(n(!0),p(M,null,se(Array.isArray(a.value)?a.value:[a.value],(o,d)=>(n(),p("div",{key:o.name,class:u(s.value.file({class:e.ui?.file}))},[c(l.$slots,"file",{file:o,index:d},()=>[c(l.$slots,"file-leading",{file:o,index:d},()=>[A(Z,{src:Q(o),icon:i.fileIcon||t(g).ui.icons.file,size:e.size,class:u(s.value.fileLeadingAvatar({class:e.ui?.fileLeadingAvatar}))},null,8,["src","icon","size","class"])]),w("div",{class:u(s.value.fileWrapper({class:e.ui?.fileWrapper}))},[w("span",{class:u(s.value.fileName({class:e.ui?.fileName}))},[c(l.$slots,"file-name",{file:o,index:d},()=>[R(C(o.name),1)])],2),w("span",{class:u(s.value.fileSize({class:e.ui?.fileSize}))},[c(l.$slots,"file-size",{file:o,index:d},()=>[R(C(Y(o.size)),1)])],2)],2),c(l.$slots,"file-trailing",{file:o,index:d},()=>[A(re,G({color:"neutral"},{ref_for:!0},{...j.value==="grid"?{variant:"solid",size:"xs"}:{variant:"link",size:i.size},...typeof i.fileDelete=="object"?i.fileDelete:void 0},{"trailing-icon":i.fileDeleteIcon||t(g).ui.icons.close,class:s.value.fileTrailingButton({class:e.ui?.fileTrailingButton}),onClick:oe(I=>k(d),["stop","prevent"])}),null,16,["trailing-icon","class","onClick"])])])],2))),128))])],2),c(l.$slots,"files-bottom",{files:a.value,open:t(v),removeFile:k})],64)):m("",!0)]),_:3}),A(t(ce),{as:i.as,class:u(s.value.root({class:[e.ui?.root,e.class]}))},{default:E(()=>[c(l.$slots,"default",{open:t(v),removeFile:k},()=>[(n(),$(ue(z.value==="button"?"button":"div"),{ref_key:"dropzoneRef",ref:r,role:z.value==="button"?void 0:"button","data-dragging":t(S),class:u(s.value.base({class:e.ui?.base})),tabindex:i.interactive&&!t(W)?0:-1,onClick:f[0]||(f[0]=o=>i.interactive&&!t(W)&&t(v)())},{default:E(()=>[D.value==="inside"?(n(),$(t(q),{key:0})):m("",!0),D.value!=="inside"||(i.multiple?!a.value?.length:!a.value)?(n(),p("div",{key:1,class:u(s.value.wrapper({class:e.ui?.wrapper}))},[c(l.$slots,"leading",{},()=>[z.value==="button"?(n(),$(ne,{key:0,name:i.icon||t(g).ui.icons.upload,class:u(s.value.icon({class:e.ui?.icon}))},null,8,["name","class"])):(n(),$(Z,{key:1,icon:i.icon||t(g).ui.icons.upload,size:e.size,class:u(s.value.avatar({class:e.ui?.avatar}))},null,8,["icon","size","class"]))]),z.value!=="button"?(n(),p(M,{key:0},[i.label||x.label?(n(),p("div",{key:0,class:u(s.value.label({class:e.ui?.label}))},[c(l.$slots,"label",{},()=>[R(C(i.label),1)])],2)):m("",!0),i.description||x.description?(n(),p("div",{key:1,class:u(s.value.description({class:e.ui?.description}))},[c(l.$slots,"description",{},()=>[R(C(i.description),1)])],2)):m("",!0),x.actions?(n(),p("div",{key:2,class:u(s.value.actions({class:e.ui?.actions}))},[c(l.$slots,"actions",{files:a.value,open:t(v),removeFile:k})],2)):m("",!0)],64)):m("",!0)],2)):m("",!0)]),_:3},8,["role","data-dragging","class","tabindex"])),D.value==="outside"?(n(),$(t(q),{key:0})):m("",!0)]),w("input",G({id:t(B),ref_key:"inputRef",ref:h,type:"file",name:t(X),accept:i.accept,multiple:i.multiple,required:i.required,disabled:t(W)},{...l.$attrs,...t(H)},{class:"sr-only",tabindex:"-1"}),null,16,ye)]),_:3},8,["as","class"])],64))}});export{xe as default};
