import{b7 as Ce,C as _,au as z,ax as Ee,aw as J,b8 as ie,r as w,av as le,O as we,d2 as W,V as K,e as k,w as x,W as I,f as ne,G as t,ai as R,a2 as F,ay as xe,g as se,aB as S,aP as O,a6 as Q,I as D,cX as Ke,o as ke,c as Be,a1 as ue,c_ as Ve,dp as _e}from"./MogBoXCm.js";import{u as re}from"./CJ7HaoCe.js";import{g as Ie}from"./fqK0r71P.js";import{u as Fe}from"./Dp3rvgMI.js";import{u as Le}from"./C90AKqnk.js";import{u as He}from"./Dyt_t8ZL.js";import{_ as $e}from"./DzBD7pt7.js";import{u as Ae}from"./kRIii9yh.js";import{f as Se}from"./DFnh3QzB.js";function Te(s,u,a){return s===void 0?!1:Array.isArray(s)?s.some(l=>A(l,u,a)):A(s,u,a)}function A(s,u,a){return s===void 0||u===void 0?!1:typeof s=="string"?s===u:typeof a=="function"?a(s,u):typeof a=="string"?s?.[a]===u?.[a]:Ce(s,u)}const[Y,Pe]=z("ListboxRoot"),Qe=_({__name:"ListboxRoot",props:{modelValue:{},defaultValue:{},multiple:{type:Boolean},orientation:{default:"vertical"},dir:{},disabled:{type:Boolean},selectionBehavior:{default:"toggle"},highlightOnHover:{type:Boolean},by:{},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean}},emits:["update:modelValue","highlight","entryFocus","leave"],setup(s,{expose:u,emit:a}){const l=s,c=a,{multiple:n,highlightOnHover:h,orientation:g,disabled:r,selectionBehavior:C,dir:y}=Ee(l),{getItems:p}=J({isProvider:!0}),{handleTypeaheadSearch:L}=Fe(),{primitiveElement:T,currentElement:f}=ie(),E=Ae(),P=Le(y),de=He(f),M=w(),H=w(!1),q=w(!0),v=le(l,"modelValue",c,{defaultValue:l.defaultValue??(n.value?[]:void 0),passive:l.modelValue===void 0,deep:!0});function ce(e){if(H.value=!0,l.multiple){const o=Array.isArray(v.value)?[...v.value]:[],i=o.findIndex(d=>A(d,e,l.by));l.selectionBehavior==="toggle"?(i===-1?o.push(e):o.splice(i,1),v.value=o):(v.value=[e],M.value=e)}else l.selectionBehavior==="toggle"&&A(v.value,e,l.by)?v.value=void 0:v.value=e;setTimeout(()=>{H.value=!1},1)}const m=w(null),N=w(null),B=w(!1),G=w(!1),Z=W(),j=W(),ee=W();function U(){return p().map(e=>e.ref).filter(e=>e.dataset.disabled!=="")}function b(e,o=!0){if(!e)return;m.value=e,q.value&&m.value.focus(),o&&m.value.scrollIntoView({block:"nearest"});const i=p().find(d=>d.ref===e);c("highlight",i)}function fe(e){if(B.value)ee.trigger(e);else{const o=p().find(i=>A(i.value,e,l.by));o&&(m.value=o.ref,b(o.ref))}}function ve(e){m.value&&m.value.isConnected&&(e.preventDefault(),e.stopPropagation(),G.value||m.value.click())}function me(e){if(q.value){if(H.value=!0,B.value)j.trigger(e);else{const o=e.altKey||e.ctrlKey||e.metaKey;if(o&&e.key==="a"&&n.value){const i=p(),d=i.map(V=>V.value);v.value=[...d],e.preventDefault(),b(i[i.length-1].ref)}else if(!o){const i=L(e.key,p());i&&b(i)}}setTimeout(()=>{H.value=!1},1)}}function pe(){G.value=!0}function he(){requestAnimationFrame(()=>{G.value=!1})}function te(){R(()=>{const e=new KeyboardEvent("keydown",{key:"PageUp"});ae(e)})}function X(e){const o=m.value;o?.isConnected&&(N.value=o),m.value=null,c("leave",e)}function ge(e){const o=new CustomEvent("listbox.entryFocus",{bubbles:!1,cancelable:!0});if(e.currentTarget?.dispatchEvent(o),c("entryFocus",o),!o.defaultPrevented)if(N.value)b(N.value);else{const i=U()?.[0];b(i)}}function ae(e){const o=Ie(e,g.value,P.value);if(!o)return;let i=U();if(m.value){if(o==="last")i.reverse();else if(o==="prev"||o==="next"){o==="prev"&&i.reverse();const d=i.indexOf(m.value);i=i.slice(d+1)}ye(e,i[0])}if(i.length){const d=!m.value&&o==="prev"?i.length-1:0;b(i[d])}if(B.value)return j.trigger(e)}function ye(e,o){if(!(B.value||l.selectionBehavior!=="replace"||!n.value||!Array.isArray(v.value)||(e.altKey||e.ctrlKey||e.metaKey)&&!e.shiftKey)&&e.shiftKey){const d=p().filter($=>$.ref.dataset.disabled!=="");let V=d.find($=>$.ref===o)?.value;if(e.key===E.END?V=d[d.length-1].value:e.key===E.HOME&&(V=d[0].value),!V||!M.value)return;const be=Se(d.map($=>$.value),M.value,V);v.value=be}}async function oe(e){if(await R(),B.value)Z.trigger(e);else{const o=U(),i=o.find(d=>d.dataset.state==="checked");i?b(i):o.length&&b(o[0])}}return we(v,()=>{H.value||R(()=>{oe()})},{immediate:!0,deep:!0}),u({highlightedElement:m,highlightItem:fe,highlightFirstItem:te,highlightSelected:oe,getItems:p}),Pe({modelValue:v,onValueChange:ce,multiple:n,orientation:g,dir:P,disabled:r,highlightOnHover:h,highlightedElement:m,isVirtual:B,virtualFocusHook:Z,virtualKeydownHook:j,virtualHighlightHook:ee,by:l.by,firstValue:M,selectionBehavior:C,focusable:q,onLeave:X,onEnter:ge,changeHighlight:b,onKeydownEnter:ve,onKeydownNavigation:ae,onKeydownTypeAhead:me,onCompositionStart:pe,onCompositionEnd:he,highlightFirstItem:te}),(e,o)=>(k(),K(t(F),{ref_key:"primitiveElement",ref:T,as:e.as,"as-child":e.asChild,dir:t(P),"data-disabled":t(r)?"":void 0,onPointerleave:X,onFocusout:o[0]||(o[0]=async i=>{const d=i.relatedTarget||i.target;await R(),m.value&&t(f)&&!t(f).contains(d)&&X(i)})},{default:x(()=>[I(e.$slots,"default",{modelValue:t(v)}),t(de)&&e.name?(k(),K(t($e),{key:0,name:e.name,value:t(v),disabled:t(r),required:e.required},null,8,["name","value","disabled","required"])):ne("",!0)]),_:3},8,["as","as-child","dir","data-disabled"]))}}),Ye=_({__name:"ListboxContent",props:{asChild:{type:Boolean},as:{}},setup(s){const{CollectionSlot:u}=J(),a=Y(),l=xe(!1,10);return(c,n)=>(k(),K(t(u),null,{default:x(()=>[se(t(F),{role:"listbox",as:c.as,"as-child":c.asChild,tabindex:t(a).focusable.value?t(a).highlightedElement.value?"-1":"0":void 0,"aria-orientation":t(a).orientation.value,"aria-multiselectable":!!t(a).multiple.value,"data-orientation":t(a).orientation.value,onMousedown:n[0]||(n[0]=O(h=>l.value=!0,["left"])),onFocus:n[1]||(n[1]=h=>{t(l)||t(a).onEnter(h)}),onKeydown:[n[2]||(n[2]=S(O(h=>{t(a).focusable.value&&t(a).onKeydownNavigation(h)},["prevent"]),["down","up","left","right","home","end"])),S(t(a).onKeydownEnter,["enter"]),t(a).onKeydownTypeAhead]},{default:x(()=>[I(c.$slots,"default")]),_:3},8,["as","as-child","tabindex","aria-orientation","aria-multiselectable","data-orientation","onKeydown"])]),_:3}))}}),[Ze,Me]=z("ListboxGroup"),et=_({__name:"ListboxGroup",props:{asChild:{type:Boolean},as:{}},setup(s){const u=s,a=re(void 0,"reka-listbox-group");return Me({id:a}),(l,c)=>(k(),K(t(F),Q({role:"group"},u,{"aria-labelledby":t(a)}),{default:x(()=>[I(l.$slots,"default")]),_:3},16,["aria-labelledby"]))}}),tt=_({__name:"ListboxFilter",props:{modelValue:{},autoFocus:{type:Boolean},disabled:{type:Boolean},asChild:{type:Boolean},as:{default:"input"}},emits:["update:modelValue"],setup(s,{emit:u}){const a=s,c=le(a,"modelValue",u,{defaultValue:"",passive:a.modelValue===void 0}),n=Y(),{primitiveElement:h,currentElement:g}=ie(),r=D(()=>a.disabled||n.disabled.value||!1),C=w();return Ke(()=>C.value=n.highlightedElement.value?.id),ke(()=>{n.focusable.value=!1,setTimeout(()=>{a.autoFocus&&g.value?.focus()},1)}),Be(()=>{n.focusable.value=!0}),(y,p)=>(k(),K(t(F),{ref_key:"primitiveElement",ref:h,as:y.as,"as-child":y.asChild,value:t(c),disabled:r.value?"":void 0,"data-disabled":r.value?"":void 0,"aria-disabled":r.value??void 0,"aria-activedescendant":C.value,type:"text",onKeydown:[S(O(t(n).onKeydownNavigation,["prevent"]),["down","up","home","end"]),S(t(n).onKeydownEnter,["enter"])],onInput:p[0]||(p[0]=L=>{c.value=L.target.value,t(n).highlightFirstItem()}),onCompositionstart:t(n).onCompositionStart,onCompositionend:t(n).onCompositionEnd},{default:x(()=>[I(y.$slots,"default",{modelValue:t(c)})]),_:3},8,["as","as-child","value","disabled","data-disabled","aria-disabled","aria-activedescendant","onKeydown","onCompositionstart","onCompositionend"]))}}),Re="listbox.select",[De,Oe]=z("ListboxItem"),at=_({__name:"ListboxItem",props:{value:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{default:"div"}},emits:["select"],setup(s,{emit:u}){const a=s,l=u,c=re(void 0,"reka-listbox-item"),{CollectionItem:n}=J(),{forwardRef:h,currentElement:g}=ue(),r=Y(),C=D(()=>g.value===r.highlightedElement.value),y=D(()=>Te(r.modelValue.value,a.value,r.by)),p=D(()=>r.disabled.value||a.disabled);async function L(f){l("select",f),!f?.defaultPrevented&&!p.value&&f&&(r.onValueChange(a.value),r.changeHighlight(g.value))}function T(f){const E={originalEvent:f,value:a.value};_e(Re,L,E)}return Oe({isSelected:y}),(f,E)=>(k(),K(t(n),{value:f.value},{default:x(()=>[Ve([C.value,y.value],()=>se(t(F),Q({id:t(c)},f.$attrs,{ref:t(h),role:"option",tabindex:t(r).focusable.value?C.value?"0":"-1":-1,"aria-selected":y.value,as:f.as,"as-child":f.asChild,disabled:p.value?"":void 0,"data-disabled":p.value?"":void 0,"data-highlighted":C.value?"":void 0,"data-state":y.value?"checked":"unchecked",onClick:T,onKeydown:S(O(T,["prevent"]),["space"]),onPointermove:E[0]||(E[0]=P=>{t(r).highlightedElement.value!==t(g)&&(t(r).highlightOnHover.value?t(r).changeHighlight(t(g),!1):t(r).focusable.value||t(r).changeHighlight(t(g),!1))})}),{default:x(()=>[I(f.$slots,"default")]),_:3},16,["id","tabindex","aria-selected","as","as-child","disabled","data-disabled","data-highlighted","data-state","onKeydown"]),E,1)]),_:3},8,["value"]))}}),ot=_({__name:"ListboxItemIndicator",props:{asChild:{type:Boolean},as:{default:"span"}},setup(s){const u=s;ue();const a=De();return(l,c)=>t(a).isSelected.value?(k(),K(t(F),Q({key:0,"aria-hidden":"true"},u),{default:x(()=>[I(l.$slots,"default")]),_:3},16)):ne("",!0)}});export{tt as _,et as a,at as b,ot as c,Ye as d,Qe as e,Y as f,Ze as i};
