import{r as A,J as F,H as t,O as ae,b as te,P as X,bv as E,Y as ie,bw as se,z as re,bx as oe,bR as ne,ay as ue,e as v,f as u,h as C,w as K,g as m,F as M,X as d,i as L,E as ce,n as c,a6 as P,B as U,t as V,W as B,a7 as Z,aF as G,G as de,K as fe,an as H,aB as pe,av as ve,ab as me,a8 as J}from"./BTXGmdcq.js";import{h as ge,i as be,c as ye}from"./nCACF461.js";function he(a){if(!a||a==="*")return;const z=a.split(",").map(x=>{const e=x.trim();return e.includes("/")&&e.endsWith("/*")&&e.split("/")[0]||e}).filter(x=>!x.startsWith("."));return z.length>0?z:void 0}function ze(a){const{accept:z="*",reset:x=!1,multiple:e=!1,dropzone:W=!0,onUpdate:q}=a,i=A(),g=A(),N=F(()=>he(t(z))),T=(r,y=!1)=>{if(!(!r||r.length===0)){if(r instanceof FileList&&(r=Array.from(r)),r.length>1&&!e&&(r=[r[0]]),y&&i.value?.$el)try{const h=new DataTransfer;r.forEach(p=>h.items.add(p)),i.value.$el.files=h.files}catch(h){console.warn("Could not sync files to input element:",h)}q(r)}},$=A(!1),D=ae({open:()=>{}});function b(){D.open()}return te(()=>{const{isOverDropZone:r}=W?ge(g,{dataTypes:N.value,onDrop:p=>T(p,!0)}):{isOverDropZone:A(!1)};X(r,p=>{$.value=p});const{onChange:y,open:h}=be({accept:t(z),multiple:e,input:t(i)?.$el,reset:x});D.open=h,y(p=>T(p,!1))}),{isDragging:$,open:b,inputRef:i,dropzoneRef:g}}const xe={slots:{root:"relative flex flex-col",base:["w-full flex-1 bg-default border border-default flex flex-col gap-2 items-stretch justify-center rounded-lg focus-visible:outline-2","transition-[background]"],wrapper:"flex flex-col items-center justify-center text-center",icon:"shrink-0",avatar:"shrink-0",label:"font-medium text-default mt-2",description:"text-muted mt-1",actions:"flex flex-wrap gap-1.5 shrink-0 mt-4",files:"",file:"relative",fileLeadingAvatar:"shrink-0",fileWrapper:"flex flex-col min-w-0",fileName:"text-default truncate",fileSize:"text-muted truncate",fileTrailingButton:""},variants:{color:{primary:"",secondary:"",important:"",info:"",success:"",warning:"",error:"",neutral:""},variant:{area:{wrapper:"px-4 py-3",base:"p-4"},button:{}},size:{xs:{base:"text-xs",icon:"size-4",file:"text-xs px-2 py-1 gap-1",fileWrapper:"flex-row gap-1"},sm:{base:"text-xs",icon:"size-4",file:"text-xs px-2.5 py-1.5 gap-1.5",fileWrapper:"flex-row gap-1"},md:{base:"text-sm",icon:"size-5",file:"text-xs px-2.5 py-1.5 gap-1.5"},lg:{base:"text-sm",icon:"size-5",file:"text-sm px-3 py-2 gap-2",fileSize:"text-xs"},xl:{base:"text-base",icon:"size-6",file:"text-sm px-3 py-2 gap-2"}},layout:{list:{root:"gap-2 items-start",files:"flex flex-col w-full gap-2",file:"min-w-0 flex items-center border border-default rounded-md w-full",fileTrailingButton:"ms-auto"},grid:{fileWrapper:"hidden",fileLeadingAvatar:"size-full rounded-lg",fileTrailingButton:"absolute -top-1.5 -end-1.5 p-0 rounded-full border-2 border-bg"}},position:{inside:"",outside:""},dropzone:{true:"border-dashed data-[dragging=true]:bg-elevated/25"},interactive:{true:""},highlight:{true:""},multiple:{true:""},disabled:{true:"cursor-not-allowed opacity-75"}},compoundVariants:[{color:"primary",class:"focus-visible:outline-primary"},{color:"secondary",class:"focus-visible:outline-secondary"},{color:"important",class:"focus-visible:outline-important"},{color:"info",class:"focus-visible:outline-info"},{color:"success",class:"focus-visible:outline-success"},{color:"warning",class:"focus-visible:outline-warning"},{color:"error",class:"focus-visible:outline-error"},{color:"primary",highlight:!0,class:"border-primary"},{color:"secondary",highlight:!0,class:"border-secondary"},{color:"important",highlight:!0,class:"border-important"},{color:"info",highlight:!0,class:"border-info"},{color:"success",highlight:!0,class:"border-success"},{color:"warning",highlight:!0,class:"border-warning"},{color:"error",highlight:!0,class:"border-error"},{color:"neutral",class:"focus-visible:outline-inverted"},{color:"neutral",highlight:!0,class:"border-inverted"},{size:"xs",layout:"list",class:{fileTrailingButton:"-me-1"}},{size:"sm",layout:"list",class:{fileTrailingButton:"-me-1.5"}},{size:"md",layout:"list",class:{fileTrailingButton:"-me-1.5"}},{size:"lg",layout:"list",class:{fileTrailingButton:"-me-2"}},{size:"xl",layout:"list",class:{fileTrailingButton:"-me-2"}},{variant:"button",size:"xs",class:{base:"p-1"}},{variant:"button",size:"sm",class:{base:"p-1.5"}},{variant:"button",size:"md",class:{base:"p-1.5"}},{variant:"button",size:"lg",class:{base:"p-2"}},{variant:"button",size:"xl",class:{base:"p-2"}},{layout:"grid",multiple:!0,class:{files:"grid grid-cols-2 md:grid-cols-3 gap-4 w-full",file:"p-0 aspect-square"}},{layout:"grid",multiple:!1,class:{file:"absolute inset-0 p-0"}},{interactive:!0,disabled:!1,class:"hover:bg-elevated/25"}],defaultVariants:{color:"primary",variant:"area",size:"md"}},$e=Object.assign({inheritAttrs:!1},{__name:"UFileUpload",props:E({as:{type:null,required:!1},id:{type:String,required:!1},name:{type:String,required:!1},icon:{type:null,required:!1},label:{type:String,required:!1},description:{type:String,required:!1},color:{type:null,required:!1},variant:{type:null,required:!1},size:{type:null,required:!1},layout:{type:null,required:!1,default:"grid"},position:{type:null,required:!1,default:"outside"},highlight:{type:Boolean,required:!1},accept:{type:String,required:!1,default:"*"},multiple:{type:Boolean,required:!1,default:!1},reset:{type:Boolean,required:!1,default:!1},dropzone:{type:Boolean,required:!1,default:!0},interactive:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},fileIcon:{type:null,required:!1},fileDelete:{type:[Boolean,Object],required:!1,default:!0},fileDeleteIcon:{type:null,required:!1},preview:{type:Boolean,required:!1,default:!0},class:{type:null,required:!1},ui:{type:null,required:!1}},{modelValue:{type:null},modelModifiers:{}}),emits:E(["change"],["update:modelValue"]),setup(a,{expose:z,emit:x}){const e=a,W=x,q=ie(),i=se(a,"modelValue"),g=re(),{t:N}=oe(),[T,$]=ye(),{isDragging:D,open:b,inputRef:r,dropzoneRef:y}=ze({accept:e.accept,reset:e.reset,multiple:e.multiple,dropzone:e.dropzone,onUpdate:O}),{emitFormInput:h,emitFormChange:p,id:Y,name:Q,disabled:S,ariaAttrs:_}=ne(e),w=F(()=>e.multiple?"area":e.variant),j=F(()=>e.variant==="button"&&!e.multiple?"grid":e.layout),R=F(()=>j.value==="grid"&&e.multiple?"inside":w.value==="button"?"outside":e.position),s=F(()=>J({extend:J(xe),...g.ui?.fileUpload||{}})({dropzone:e.dropzone,interactive:e.interactive,color:e.color,size:e.size,variant:w.value,layout:j.value,position:R.value,multiple:e.multiple,highlight:e.highlight,disabled:e.disabled}));function ee(l){return URL.createObjectURL(l)}function le(l){if(l===0)return"0B";const n=1024,o=["B","KB","MB","GB"],f=Math.floor(Math.log(l)/Math.log(n)),I=l/Math.pow(n,f);return`${f===0?I.toString():I.toFixed(0)}${o[f]}`}function O(l,n=!1){if(e.multiple)if(n)i.value=l;else{const f=i.value||[];i.value=[...f,...l||[]]}else i.value=l?.[0];const o=new Event("change",{target:{value:i.value}});W("change",o),p(),h()}function k(l){if(!i.value)return;if(!e.multiple||l===void 0){O([],!0),y.value?.focus();return}const n=[...i.value];n.splice(l,1),O(n,!0),y.value?.focus()}return X(i,l=>{(e.multiple?!l?.length:!l)&&r.value?.$el&&(r.value.$el.value="")}),z({inputRef:ue(()=>r.value?.$el),dropzoneRef:y}),(l,n)=>(u(),v(M,null,[C(t(T),null,{default:K(()=>[e.preview&&i.value&&(!Array.isArray(i.value)||i.value.length)?(u(),v(M,{key:0},[d(l.$slots,"files-top",{files:i.value,open:t(b),removeFile:k}),L("div",{"data-slot":"files",class:c(s.value.files({class:e.ui?.files}))},[d(l.$slots,"files",{files:i.value},()=>[(u(!0),v(M,null,ce(Array.isArray(i.value)?i.value:[i.value],(o,f)=>(u(),v("div",{key:o.name,"data-slot":"file",class:c(s.value.file({class:e.ui?.file}))},[d(l.$slots,"file",{file:o,index:f},()=>[d(l.$slots,"file-leading",{file:o,index:f,ui:s.value},()=>[C(P,{as:{img:"img"},src:ee(o),icon:a.fileIcon||t(g).ui.icons.file,size:e.size,"data-slot":"fileLeadingAvatar",class:c(s.value.fileLeadingAvatar({class:e.ui?.fileLeadingAvatar}))},null,8,["src","icon","size","class"])]),L("div",{"data-slot":"fileWrapper",class:c(s.value.fileWrapper({class:e.ui?.fileWrapper}))},[L("span",{"data-slot":"fileName",class:c(s.value.fileName({class:e.ui?.fileName}))},[d(l.$slots,"file-name",{file:o,index:f},()=>[U(V(o.name),1)])],2),L("span",{"data-slot":"fileSize",class:c(s.value.fileSize({class:e.ui?.fileSize}))},[d(l.$slots,"file-size",{file:o,index:f},()=>[U(V(le(o.size)),1)])],2)],2),d(l.$slots,"file-trailing",{file:o,index:f,ui:s.value},()=>[a.fileDelete?(u(),B(de,Z({key:0,color:"neutral"},{ref_for:!0},{...j.value==="grid"?{variant:"solid",size:"xs"}:{variant:"link",size:a.size},...typeof a.fileDelete=="object"?a.fileDelete:void 0},{"aria-label":t(N)("fileUpload.removeFile",{filename:o.name}),"trailing-icon":a.fileDeleteIcon||t(g).ui.icons.close,"data-slot":"fileTrailingButton",class:s.value.fileTrailingButton({class:e.ui?.fileTrailingButton}),onClick:G(I=>k(f),["stop","prevent"])}),null,16,["aria-label","trailing-icon","class","onClick"])):m("",!0)])])],2))),128))])],2),d(l.$slots,"files-bottom",{files:i.value,open:t(b),removeFile:k})],64)):m("",!0)]),_:3}),C(t(me),{as:a.as,"data-slot":"root",class:c(s.value.root({class:[e.ui?.root,e.class]}))},{default:K(()=>[d(l.$slots,"default",{open:t(b),removeFile:k,ui:s.value},()=>[(u(),B(pe(w.value==="button"?"button":"div"),{ref_key:"dropzoneRef",ref:y,type:w.value==="button"?"button":void 0,role:w.value==="button"?void 0:"button","data-dragging":t(D),"data-slot":"base",class:c(s.value.base({class:e.ui?.base})),tabindex:a.interactive&&!t(S)?0:-1,onClick:n[0]||(n[0]=o=>a.interactive&&!t(S)&&t(b)()),onKeydown:n[1]||(n[1]=H(G(()=>{},["prevent"]),["space"])),onKeyup:n[2]||(n[2]=H(o=>a.interactive&&!t(S)&&t(b)(),["enter","space"]))},{default:K(()=>[R.value==="inside"?(u(),B(t($),{key:0})):m("",!0),R.value!=="inside"||(a.multiple?!i.value?.length:!i.value)?(u(),v("div",{key:1,"data-slot":"wrapper",class:c(s.value.wrapper({class:e.ui?.wrapper}))},[d(l.$slots,"leading",{ui:s.value},()=>[w.value==="button"?(u(),B(fe,{key:0,name:a.icon||t(g).ui.icons.upload,"data-slot":"icon",class:c(s.value.icon({class:e.ui?.icon}))},null,8,["name","class"])):(u(),B(P,{key:1,icon:a.icon||t(g).ui.icons.upload,size:e.size,"data-slot":"avatar",class:c(s.value.avatar({class:e.ui?.avatar}))},null,8,["icon","size","class"]))]),w.value!=="button"?(u(),v(M,{key:0},[a.label||q.label?(u(),v("div",{key:0,"data-slot":"label",class:c(s.value.label({class:e.ui?.label}))},[d(l.$slots,"label",{},()=>[U(V(a.label),1)])],2)):m("",!0),a.description||q.description?(u(),v("div",{key:1,"data-slot":"description",class:c(s.value.description({class:e.ui?.description}))},[d(l.$slots,"description",{},()=>[U(V(a.description),1)])],2)):m("",!0),q.actions?(u(),v("div",{key:2,"data-slot":"actions",class:c(s.value.actions({class:e.ui?.actions}))},[d(l.$slots,"actions",{files:i.value,open:t(b),removeFile:k})],2)):m("",!0)],64)):m("",!0)],2)):m("",!0)]),_:3},40,["type","role","data-dragging","class","tabindex"])),R.value==="outside"?(u(),B(t($),{key:0})):m("",!0)]),C(t(ve),Z({id:t(Y),ref_key:"inputRef",ref:r,as:"input",type:"file",feature:"fully-hidden",name:t(Q),accept:a.accept,multiple:a.multiple,required:a.required,disabled:t(S)},{...l.$attrs,...t(_)}),null,16,["id","name","accept","multiple","required","disabled"])]),_:3},8,["as","class"])],64))}});export{$e as default};
