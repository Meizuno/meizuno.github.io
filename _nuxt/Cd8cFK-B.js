import{bl as g,r as O,D as C,ag as L,O as w,ak as y,W as A,f as x,w as K,X as N,H as U,ab as q,as as B,bm as i,ax as D,am as v,bn as E,bo as I,bp as M,bq as b,br as T,bs as P}from"./BTXGmdcq.js";const R=g(()=>O([]));function H(){const s=R();return{add(n){const a=s.value[0];n!==a&&a?.pause(),s.value=_(s.value,n),s.value.unshift(n)},remove(n){s.value=_(s.value,n),s.value[0]?.resume()}}}function _(s,n){const a=[...s],l=a.indexOf(n);return l!==-1&&a.splice(l,1),a}function G(s){return s.filter(n=>n.tagName!=="A")}var V=C({__name:"FocusScope",props:{loop:{type:Boolean,required:!1,default:!1},trapped:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["mountAutoFocus","unmountAutoFocus"],setup(s,{emit:n}){const a=s,l=n,{currentRef:S,currentElement:F}=L(),p=O(null),h=H(),m=w({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}});y(t=>{if(!B)return;const e=F.value;if(!a.trapped)return;function o(c){if(m.paused||!e)return;const f=c.target;e.contains(f)?p.value=f:i(p.value,{select:!0})}function d(c){if(m.paused||!e)return;const f=c.relatedTarget;f!==null&&(e.contains(f)||i(p.value,{select:!0}))}function u(c){e.contains(p.value)||i(e)}document.addEventListener("focusin",o),document.addEventListener("focusout",d);const r=new MutationObserver(u);e&&r.observe(e,{childList:!0,subtree:!0}),t(()=>{document.removeEventListener("focusin",o),document.removeEventListener("focusout",d),r.disconnect()})}),y(async t=>{const e=F.value;if(await D(),!e)return;h.add(m);const o=v();if(!e.contains(o)){const u=new CustomEvent(E,T);e.addEventListener(E,r=>l("mountAutoFocus",r)),e.dispatchEvent(u),u.defaultPrevented||(I(G(M(e)),{select:!0}),v()===o&&i(e))}t(()=>{e.removeEventListener(E,c=>l("mountAutoFocus",c));const u=new CustomEvent(b,T),r=c=>{l("unmountAutoFocus",c)};e.addEventListener(b,r),e.dispatchEvent(u),setTimeout(()=>{u.defaultPrevented||i(o??document.body,{select:!0}),e.removeEventListener(b,r),h.remove(m)},0)})});function k(t){if(!a.loop&&!a.trapped||m.paused)return;const e=t.key==="Tab"&&!t.altKey&&!t.ctrlKey&&!t.metaKey,o=v();if(e&&o){const d=t.currentTarget,[u,r]=P(d);u&&r?!t.shiftKey&&o===r?(t.preventDefault(),a.loop&&i(u,{select:!0})):t.shiftKey&&o===u&&(t.preventDefault(),a.loop&&i(r,{select:!0})):o===d&&t.preventDefault()}}return(t,e)=>(x(),A(U(q),{ref_key:"currentRef",ref:S,tabindex:"-1","as-child":t.asChild,as:t.as,onKeydown:k},{default:K(()=>[N(t.$slots,"default")]),_:3},8,["as-child","as"]))}}),X=V;export{X as F};
