import{c as se}from"./DjOUmZJi.js";import{r as U,C as te,au as re,ax as oe,av as Q,I as B,d2 as ue,V as P,e as T,w as V,g as $,G as c,a2 as ae,aB as M,aP as O,W as _,ai as de,at as J,aw as ce,a6 as R,dp as Z,X as fe,y as ve,a3 as pe,a4 as ge,d as z,F as ee,D as ye,n as w,h as he,f as D,J as W,A as me,t as be,a7 as le,a5 as j}from"./B6DZa6Xn.js";import{M as ke}from"./DxFXT0_I.js";import{u as xe}from"./C4URYAVW.js";import{u as Ie}from"./DOYQAGro.js";import{f as H}from"./TRjR_GAa.js";import{_ as Te}from"./BEhHpKSl.js";import{_ as Ke}from"./B6kNRRPC.js";import"./BkuDZFvC.js";function F(n){return n.reduce((y,e)=>(y.push(e),e.children&&y.push(...F(e.children)),y),[])}function Ce(n,y){const e=U(),f=(t,K)=>{if(y.multiple&&Array.isArray(n.value))if(y.selectionBehavior==="replace")n.value=[t],e.value=t;else{const h=n.value.findIndex(u=>K(u));h!==-1?n.value=n.value.filter((u,o)=>o!==h):n.value=[...n.value,t]}else y.selectionBehavior==="replace"?n.value={...t}:!Array.isArray(n.value)&&K(n.value)?n.value=void 0:n.value={...t};return n.value};function A(t,K,h,u){if(!e?.value||!y.multiple||!Array.isArray(n.value))return;const S=h().filter(b=>b.ref.dataset.disabled!=="").find(b=>b.ref===K)?.value;if(!S)return;let m=null;switch(t){case"prev":case"next":{m=H(u,e.value,S);break}case"first":{m=H(u,e.value,u?.[0]);break}case"last":{m=H(u,e.value,u?.[u.length-1]);break}}n.value=m}return{firstValue:e,onSelectItem:f,handleMultipleReplace:A}}const[Se,Ae]=re("TreeRoot"),Ee=te({__name:"TreeRoot",props:{modelValue:{},defaultValue:{},items:{},expanded:{},defaultExpanded:{},getKey:{},getChildren:{type:Function,default:n=>n.children},selectionBehavior:{default:"toggle"},multiple:{},dir:{},disabled:{type:Boolean},propagateSelect:{type:Boolean},bubbleSelect:{type:Boolean},asChild:{type:Boolean},as:{default:"ul"}},emits:["update:modelValue","update:expanded"],setup(n,{emit:y}){const e=n,f=y,{items:A,multiple:t,disabled:K,propagateSelect:h,dir:u,bubbleSelect:o}=oe(e),{handleTypeaheadSearch:S}=xe(),m=Ie(u),b=U(),L=U(!1),d=ue(),s=Q(e,"modelValue",f,{defaultValue:e.defaultValue??(t.value?[]:void 0),passive:e.modelValue===void 0,deep:!0}),g=Q(e,"expanded",f,{defaultValue:e.defaultExpanded??[],passive:e.expanded===void 0,deep:!0}),{onSelectItem:a,handleMultipleReplace:l}=Ce(s,e),r=B(()=>t.value&&Array.isArray(s.value)?s.value.map(i=>e.getKey(i)):[e.getKey(s.value??{})]);function k(i,v=1,I){return i.reduce((p,C,N)=>{const Y=e.getKey(C),G=e.getChildren(C),ne=g.value.includes(Y),ie={_id:Y,value:C,index:N,level:v,parentItem:I,hasChildren:!!G,bind:{value:C,level:v,"aria-setsize":i.length,"aria-posinset":N+1}};return p.push(ie),G&&ne&&p.push(...k(G,v+1,C)),p},[])}const x=B(()=>{const i=e.items;return g.value.map(v=>v),k(i??[])});function q(i){if(L.value)d.trigger(i);else{const v=b.value?.getItems()??[];S(i.key,v)}}function E(i){if(L.value)return;const v=ke[i.key];de(()=>{l(v,J(),b.value?.getItems,x.value.map(I=>I.value))})}function X(i){if(i.parentItem!=null&&Array.isArray(s.value)&&e.multiple){const v=x.value.find(I=>i.parentItem!=null&&e.getKey(I.value)===e.getKey(i.parentItem));v!=null&&(e.getChildren(v.value)?.every(p=>s.value.find(C=>e.getKey(C)===e.getKey(p)))?s.value=[...s.value,v.value]:s.value=s.value.filter(p=>e.getKey(p)!==e.getKey(v.value)),X(v))}}return Ae({modelValue:s,selectedKeys:r,onSelect:i=>{const v=p=>e.getKey(p??{})===e.getKey(i),I=e.multiple&&Array.isArray(s.value)?s.value?.findIndex(v)!==-1:void 0;if(a(i,v),e.bubbleSelect&&e.multiple&&Array.isArray(s.value)){const p=x.value.find(C=>e.getKey(C.value)===e.getKey(i));p!=null&&X(p)}if(e.propagateSelect&&e.multiple&&Array.isArray(s.value)){const p=F(e.getChildren(i)??[]);I?s.value=[...s.value].filter(C=>!p.some(N=>e.getKey(C??{})===e.getKey(N))):s.value=[...s.value,...p]}},expanded:g,onToggle(i){if(!(i?e.getChildren(i):void 0))return;const I=e.getKey(i)??i;g.value.includes(I)?g.value=g.value.filter(p=>p!==I):g.value.push(I)},getKey:e.getKey,getChildren:e.getChildren,items:A,expandedItems:x,disabled:K,multiple:t,dir:m,propagateSelect:h,bubbleSelect:o,isVirtual:L,virtualKeydownHook:d,handleMultipleReplace:l}),(i,v)=>(T(),P(c(Te),{ref_key:"rovingFocusGroupRef",ref:b,"as-child":"",orientation:"vertical",dir:c(m)},{default:V(()=>[$(c(ae),{role:"tree",as:i.as,"as-child":i.asChild,"aria-multiselectable":c(t)?!0:void 0,onKeydown:[q,M(O(E,["shift"]),["up","down"])]},{default:V(()=>[_(i.$slots,"default",{flattenItems:x.value,modelValue:c(s),expanded:c(g)})]),_:3},8,["as","as-child","aria-multiselectable","onKeydown"])]),_:3},8,["dir"]))}}),we="tree.select",Be="tree.toggle",Le=te({inheritAttrs:!1,__name:"TreeItem",props:{value:{},level:{},asChild:{type:Boolean},as:{default:"li"}},emits:["select","toggle"],setup(n,{expose:y,emit:e}){const f=n,A=e,t=Se(),{getItems:K}=ce(),h=B(()=>!!t.getChildren(f.value)),u=B(()=>{const a=t.getKey(f.value);return t.expanded.value.includes(a)}),o=B(()=>{const a=t.getKey(f.value);return t.selectedKeys.value.includes(a)}),S=B(()=>{if(t.bubbleSelect.value&&h.value&&Array.isArray(t.modelValue.value)){const a=F(t.getChildren(f.value)||[]);return a.some(l=>t.modelValue.value.find(r=>t.getKey(r)===t.getKey(l)))&&!a.every(l=>t.modelValue.value.find(r=>t.getKey(r)===t.getKey(l)))}else return t.propagateSelect.value&&o.value&&h.value&&Array.isArray(t.modelValue.value)?!F(t.getChildren(f.value)||[]).every(l=>t.modelValue.value.find(r=>t.getKey(r)===t.getKey(l))):void 0});function m(a){if(h.value)if(u.value){const l=K().map(E=>E.ref),r=J(),k=l.indexOf(r),q=[...l].slice(k).find(E=>Number(E.getAttribute("data-indent"))===f.level+1);q&&q.focus()}else g(a)}function b(a){if(u.value)g(a);else{const l=K().map(E=>E.ref),r=J(),k=l.indexOf(r),q=[...l].slice(0,k).reverse().find(E=>Number(E.getAttribute("data-indent"))===f.level-1);q&&q.focus()}}async function L(a){A("select",a),!a?.defaultPrevented&&t.onSelect(f.value)}async function d(a){A("toggle",a),!a?.defaultPrevented&&t.onToggle(f.value)}async function s(a){if(!a)return;const l={originalEvent:a,value:f.value,isExpanded:u.value,isSelected:o.value};Z(we,L,l)}async function g(a){if(!a)return;const l={originalEvent:a,value:f.value,isExpanded:u.value,isSelected:o.value};Z(Be,d,l)}return y({isExpanded:u,isSelected:o,isIndeterminate:S,handleToggle:()=>t.onToggle(f.value),handleSelect:()=>t.onSelect(f.value)}),(a,l)=>(T(),P(c(Ke),{"as-child":"",value:a.value,"allow-shift-key":""},{default:V(()=>[$(c(ae),R(a.$attrs,{role:"treeitem",as:a.as,"as-child":a.asChild,"aria-selected":o.value,"aria-expanded":h.value?u.value:void 0,"aria-level":a.level,"data-indent":a.level,"data-selected":o.value?"":void 0,"data-expanded":u.value?"":void 0,onKeydown:[M(O(s,["self","prevent"]),["enter","space"]),l[0]||(l[0]=M(O(r=>c(t).dir.value==="ltr"?m(r):b(r),["prevent"]),["right"])),l[1]||(l[1]=M(O(r=>c(t).dir.value==="ltr"?b(r):m(r),["prevent"]),["left"]))],onClick:l[2]||(l[2]=O(r=>{s(r),g(r)},["stop"]))}),{default:V(()=>[_(a.$slots,"default",{isExpanded:u.value,isSelected:o.value,isIndeterminate:S.value,handleSelect:()=>c(t).onSelect(a.value),handleToggle:()=>c(t).onToggle(a.value)})]),_:3},16,["as","as-child","aria-selected","aria-expanded","aria-level","data-indent","data-selected","data-expanded","onKeydown"])]),_:3},8,["value"]))}}),qe={slots:{root:"relative isolate",item:"",listWithChildren:"ms-4.5 border-s border-default",itemWithChildren:"ps-1.5 -ms-px",link:"relative group w-full flex items-center text-sm before:absolute before:inset-y-px before:inset-x-0 before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2",linkLeadingIcon:"shrink-0",linkLabel:"truncate",linkTrailing:"ms-auto inline-flex gap-1.5 items-center",linkTrailingIcon:"shrink-0 transform transition-transform duration-200 group-data-expanded:rotate-180"},variants:{color:{primary:{link:"focus-visible:before:ring-primary"},secondary:{link:"focus-visible:before:ring-secondary"},important:{link:"focus-visible:before:ring-important"},info:{link:"focus-visible:before:ring-info"},success:{link:"focus-visible:before:ring-success"},warning:{link:"focus-visible:before:ring-warning"},error:{link:"focus-visible:before:ring-error"},neutral:{link:"focus-visible:before:ring-inverted"}},size:{xs:{link:"px-2 py-1 text-xs gap-1",linkLeadingIcon:"size-4",linkTrailingIcon:"size-4"},sm:{link:"px-2.5 py-1.5 text-xs gap-1.5",linkLeadingIcon:"size-4",linkTrailingIcon:"size-4"},md:{link:"px-2.5 py-1.5 text-sm gap-1.5",linkLeadingIcon:"size-5",linkTrailingIcon:"size-5"},lg:{link:"px-3 py-2 text-sm gap-2",linkLeadingIcon:"size-5",linkTrailingIcon:"size-5"},xl:{link:"px-3 py-2 text-base gap-2",linkLeadingIcon:"size-6",linkTrailingIcon:"size-6"}},selected:{true:{link:"before:bg-elevated"},false:{link:["hover:not-disabled:text-highlighted hover:not-disabled:before:bg-elevated/50","transition-colors before:transition-colors"]}},disabled:{true:{link:"cursor-not-allowed opacity-75"}}},compoundVariants:[{color:"primary",selected:!0,class:{link:"text-primary"}},{color:"secondary",selected:!0,class:{link:"text-secondary"}},{color:"important",selected:!0,class:{link:"text-important"}},{color:"info",selected:!0,class:{link:"text-info"}},{color:"success",selected:!0,class:{link:"text-success"}},{color:"warning",selected:!0,class:{link:"text-warning"}},{color:"error",selected:!0,class:{link:"text-error"}},{color:"neutral",selected:!0,class:{link:"text-highlighted"}}],defaultVariants:{color:"primary",size:"md"}},$e=["disabled"],Me=Object.assign({inheritAttrs:!1},{__name:"UTree",props:{as:{type:null,required:!1},color:{type:null,required:!1},size:{type:null,required:!1},valueKey:{type:null,required:!1,default:"value"},labelKey:{type:null,required:!1,default:"label"},trailingIcon:{type:String,required:!1},expandedIcon:{type:String,required:!1},collapsedIcon:{type:String,required:!1},items:{type:null,required:!1},modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},multiple:{type:Boolean,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},expanded:{type:Array,required:!1},defaultExpanded:{type:Array,required:!1},selectionBehavior:{type:String,required:!1},propagateSelect:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},bubbleSelect:{type:Boolean,required:!1}},emits:["update:expanded","update:modelValue"],setup(n,{emit:y}){const e=n,f=y,A=fe(),t=ve(),K=pe(ge(e,"as","modelValue","defaultValue","items","multiple","expanded","disabled","propagateSelect","bubbleSelect"),f),[h,u]=se(),o=B(()=>le({extend:le(qe),...t.ui?.tree||{}})({color:e.color,size:e.size}));function S(d){return j(d,e.labelKey)}function m(d){return j(d,e.valueKey)??j(d,e.labelKey)}function b(d){const s=d.defaultExpanded?m(d):null,g=d.children?.flatMap(a=>b(a))??[];return[s,...g].filter(Boolean)}const L=B(()=>e.defaultExpanded??e.items?.flatMap(d=>b(d)));return(d,s)=>(T(),z(ee,null,[$(c(h),null,{default:V(({items:g,level:a})=>[(T(!0),z(ee,null,ye(g,(l,r)=>(T(),z("li",{key:`${a}-${r}`,class:w(a>0?o.value.itemWithChildren({class:[e.ui?.itemWithChildren,l.ui?.itemWithChildren]}):o.value.item({class:[e.ui?.item,l.ui?.item]}))},[$(c(Le),{"as-child":"",level:a,value:l,onToggle:l.onToggle,onSelect:l.onSelect},{default:V(({isExpanded:k,isSelected:x})=>[he("button",{type:"button",disabled:l.disabled||n.disabled,class:w(o.value.link({class:[e.ui?.link,l.ui?.link,l.class],selected:x,disabled:l.disabled||n.disabled}))},[_(d.$slots,l.slot||"item",R({ref_for:!0},{index:r,level:a,expanded:k,selected:x},{item:l}),()=>[_(d.$slots,l.slot?`${l.slot}-leading`:"item-leading",R({ref_for:!0},{index:r,level:a,expanded:k,selected:x},{item:l}),()=>[l.icon?(T(),P(W,{key:0,name:l.icon,class:w(o.value.linkLeadingIcon({class:[e.ui?.linkLeadingIcon,l.ui?.linkLeadingIcon]}))},null,8,["name","class"])):l.children?.length?(T(),P(W,{key:1,name:k?n.expandedIcon??c(t).ui.icons.folderOpen:n.collapsedIcon??c(t).ui.icons.folder,class:w(o.value.linkLeadingIcon({class:[e.ui?.linkLeadingIcon,l.ui?.linkLeadingIcon]}))},null,8,["name","class"])):D("",!0)]),S(l)||A[l.slot?`${l.slot}-label`:"item-label"]?(T(),z("span",{key:0,class:w(o.value.linkLabel({class:[e.ui?.linkLabel,l.ui?.linkLabel]}))},[_(d.$slots,l.slot?`${l.slot}-label`:"item-label",R({ref_for:!0},{item:l,index:r,level:a,expanded:k,selected:x},{item:l}),()=>[me(be(S(l)),1)])],2)):D("",!0),l.trailingIcon||l.children?.length||A[l.slot?`${l.slot}-trailing`:"item-trailing"]?(T(),z("span",{key:1,class:w(o.value.linkTrailing({class:[e.ui?.linkTrailing,l.ui?.linkTrailing]}))},[_(d.$slots,l.slot?`${l.slot}-trailing`:"item-trailing",R({ref_for:!0},{item:l,index:r,level:a,expanded:k,selected:x},{item:l}),()=>[l.trailingIcon?(T(),P(W,{key:0,name:l.trailingIcon,class:w(o.value.linkTrailingIcon({class:[e.ui?.linkTrailingIcon,l.ui?.linkTrailingIcon]}))},null,8,["name","class"])):l.children?.length?(T(),P(W,{key:1,name:n.trailingIcon??c(t).ui.icons.chevronDown,class:w(o.value.linkTrailingIcon({class:[e.ui?.linkTrailingIcon,l.ui?.linkTrailingIcon]}))},null,8,["name","class"])):D("",!0)])],2)):D("",!0)])],10,$e),l.children?.length&&k?(T(),z("ul",{key:0,class:w(o.value.listWithChildren({class:[e.ui?.listWithChildren,l.ui?.listWithChildren]}))},[$(c(u),{items:l.children,level:a+1},null,8,["items","level"])],2)):D("",!0)]),_:2},1032,["level","value","onToggle","onSelect"])],2))),128))]),_:3}),$(c(Ee),R({...c(K),...d.$attrs},{class:o.value.root({class:[e.ui?.root,e.class]}),"get-key":m,"default-expanded":L.value,"selection-behavior":n.selectionBehavior}),{default:V(()=>[$(c(u),{items:n.items,level:0},null,8,["items"])]),_:1},16,["class","default-expanded","selection-behavior"])],64))}});export{Me as default};
